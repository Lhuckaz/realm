<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Streams</title>
    <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}" type="image/x-icon">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>

<body>
    <div class="container">
        <a href="{{ url_for('index') }}">
            <h1>ğŸ§²ğŸ¬ Realm</h1>
        </a>

        {% if error %}
        <div class="error">{{ error }}</div>
        {% endif %}

        {% if movie %}
        <h2>{{ movie.title }} ({{ movie.year }})</h2>

        {% if movie.poster %}
        <img src="{{ movie.poster }}" alt="{{ movie.title }}" style="width:200px; border-radius: 8px;">
        {% endif %}

        {% endif %}

        <h3>{{ imdb_id }}</h3>
        {% if is_series %}
        <div>Season: {{ season }} | Episode: {{ episode }}</div>
        {% endif %}

        {% if streams %}
        <div class="results">
            {% for stream in streams %}
            <div class="stream">
                <h4>{{ stream.get('name', 'No Name') }}</h4>
                {% set title = stream.get('title', 'No Title') %}
                <div class="breakline"><b>Title:</b> {{ title.split('ğŸ‘¤')[0].strip() }}</div>

                {% if 'ğŸ‘¤' in title %}
                <div>ğŸ‘¤{{ title.split('ğŸ‘¤')[1].split('ğŸ’¾')[0].strip() }}</div>
                {% else %}
                <div>ğŸ‘¤ N/A</div>
                {% endif %}


                {% if 'ğŸ’¾' in title %}
                <div>ğŸ’¾{{ title.split('ğŸ’¾')[1].split('âš™ï¸')[0].strip() }}</div>
                {% else %}
                <div>ğŸ’¾ N/A</div>
                {% endif %}

                {% if 'âš™ï¸' in title %}
                <div>âš™ï¸{{ title.split('âš™ï¸')[1].strip() }}</div>
                {% else %}
                <div>âš™ï¸ N/A</div>
                {% endif %}

                <div class="infohash"><b>InfoHash:</b>
                    <p>{{ stream.get('infoHash', 'N/A') }}</p>
                </div>
                {% if stream.magnet_link %}
                <div class="options">
                    <a href="{{ stream.magnet_link }}">
                        <button>ğŸ§² Magnet Link</button>
                    </a>
                    <button data-original-text="ğŸ“‹ Copy Magnet Link"
                        onclick="copyMagnet('{{ stream.magnet_link }}', this)" class="magnet-button">ğŸ“‹ Copy Magnet
                        Link</button>
                    {% if is_series %}
                    <button data-original-text="ğŸš€ Send to qBittorrent"
                        onclick="sendToQB('{{ stream.magnet_link }}', '{{is_series}}', '{{ season }}', '{{ item_title }}', '{{ imdb_id }}', this)">ğŸš€
                        Send to
                        qBittorrent</button>
                    {% else %}
                    <button data-original-text="ğŸš€ Send to qBittorrent"
                        onclick="sendToQB('{{ stream.magnet_link }}', '{{is_series}}', null, null, '{{ imdb_id }}', this)">ğŸš€
                        Send to
                        qBittorrent</button>
                    {% endif %}
                </div>
                {% endif %}
            </div>
            {% endfor %}
        </div>
        {% else %}
        <p>No streams available.</p>
        {% endif %}
    </div>
    <script src="{{ url_for('static', filename='js/scripts.js') }}"></script>
</body>

</html>